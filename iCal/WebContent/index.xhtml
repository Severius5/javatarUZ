<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:p="http://primefaces.org/ui"> 

<h:head>
	<style>
		.ui-widget, .ui-widget .ui-widget {
			font-size: 90% !important;
		}	
		table {
   			border-collapse: collapse;
    		width: 100%;
		}th, td {
   			 padding: 8px;
   			 text-align: left;
   			 border-bottom: 1px solid #ddd;
		}tr:hover{background-color:#f5f5f5}
	</style>
</h:head> 
<h:body>
	<div id="addNew">
		<fieldset>
		<h:form id="addingNew">
			<legend align="center">Generator iCal</legend>
			<p:commandButton id="newButton" value="Nowy Event" type="button" styleClass="ui-mini"/>
   			<p:overlayPanel id="newPanel" for="newButton" hideEffect="fade" dynamic="true" style="width:600px">
				<p:outputLabel value="Title: ">
					<h:inputText value="#{iCalBean.eventSample.eventTitle}" required="true" maxlength="32"/>
				</p:outputLabel>
				<br/>
				<p:outputLabel value="Whole day: ">
					<h:selectBooleanCheckbox value="#{iCalBean.eventSample.wholeDay}" required="true" id="checker">
						<p:ajax update="createDate"/>
					</h:selectBooleanCheckbox>
					<br/>
				</p:outputLabel>
				<h:panelGroup id="createDate">
					<p:outputLabel value="Date start: " >
						<p:calendar value="#{iCalBean.eventSample.dateStart}" pattern="dd/MM/yyyy HH:mm" rendered="#{!iCalBean.eventSample.wholeDay}"/>
						<p:calendar value="#{iCalBean.eventSample.dateStart}" pattern="dd/MM/yyyy" rendered="#{iCalBean.eventSample.wholeDay}"/>
					</p:outputLabel>
					<br/>
					<p:outputLabel value="Date end: " >
						<p:calendar value="#{iCalBean.eventSample.dateEnd}" pattern="dd/MM/yyyy HH:mm" rendered="#{!iCalBean.eventSample.wholeDay}"/>
						<p:calendar value="#{iCalBean.eventSample.dateEnd}" pattern="dd/MM/yyyy" rendered="#{iCalBean.eventSample.wholeDay}"/>
					</p:outputLabel>
					<br/>
				</h:panelGroup>
				<p:outputLabel value="Location: ">
					<h:inputText value="#{iCalBean.eventSample.location}" required="true" maxlength="32"/>
				</p:outputLabel>
				<br/>
				<p:outputLabel value="Description:"/>
				<br/>
				<h:inputTextarea value="#{iCalBean.eventSample.description}" required="true" maxlength="150" style="height:200px;width:400px;"/>
				<br/>
				<br/>
				<br/>
				<h:commandButton action="#{iCalBean.addEvent}" value="Add event" >
					
				</h:commandButton>
				<h:commandButton ajax="false" value="Close" onclick="jQuery('#newPanel').hide()"/>
			</p:overlayPanel>
			<p:commandButton action="#{iCalBean.clearEvents()}" value="Clear All" styleClass="ui-mini" ajax="false"/>
			<p:commandButton action="#{iCalBean.generateICal()}" value="Generuj" styleClass="ui-mini" ajax="false"/>
			</h:form>
		</fieldset>
	</div>
	
	<div id="viewEvents">
		<fieldset>
			<legend align="center">Event List</legend>
			<h:form id="viewing">
			<h:dataTable value="#{iCalBean.eventList}" var="event">
				<h:column>
        			<f:facet name="header">Title</f:facet>
    				<h:inputText value="#{event.eventTitle}" ize="10" rendered="#{event.editable}" />
    				<h:outputText value="#{event.eventTitle}" rendered="#{not event.editable}" />
    			</h:column>
    			<h:column>
      			  	<f:facet name="header">Whole day</f:facet>
    				<h:selectBooleanCheckbox value="#{event.wholeDay}" rendered="#{event.editable}" >
    					<p:ajax update="@form"/>
    				</h:selectBooleanCheckbox>
    				<h:outputText value="#{event.wholeDay}" rendered="#{not event.editable}" />
    			</h:column>
    			<h:column>
        			<f:facet name="header">Date start</f:facet>
    				<h:outputText value="#{event.dateStart}" rendered="#{not event.editable and not event.wholeDay}" >
						<f:convertDateTime pattern="dd.MM.yyyy HH:mm" timeZone="GMT+2"/>
					</h:outputText>
					<h:outputText value="#{event.dateStart}" rendered="#{not event.editable and event.wholeDay}" >
						<f:convertDateTime pattern="dd.MM.yyyy" timeZone="GMT+2"/>
					</h:outputText>
    				<p:calendar value="#{event.dateStart}" pattern="dd/MM/yyyy" rendered="#{event.editable and event.wholeDay}"/>
    				<p:calendar value="#{event.dateStart}" pattern="dd/MM/yyyy HH:mm" rendered="#{event.editable and not event.wholeDay}"/>
    			</h:column>
    			<h:column>
      			  	<f:facet name="header">Date end</f:facet>
					<h:outputText value="#{event.dateEnd}" rendered="#{not event.editable and not event.wholeDay}" >
						<f:convertDateTime pattern="dd.MM.yyyy HH:mm" timeZone="GMT+2"/>
					</h:outputText>
					<h:outputText value="#{event.dateEnd}" rendered="#{not event.editable and event.wholeDay}" >
						<f:convertDateTime pattern="dd.MM.yyyy" timeZone="GMT+2"/>
					</h:outputText>
					<p:calendar value="#{event.dateEnd}" pattern="dd/MM/yyyy" rendered="#{event.editable and event.wholeDay}"/>
					<p:calendar value="#{event.dateEnd}" pattern="dd/MM/yyyy HH:mm" rendered="#{event.editable and not event.wholeDay}"/>
    			</h:column>
    			<h:column>
      			  	<f:facet name="header">Description</f:facet>
    				<h:inputText value="#{event.description}" rendered="#{event.editable}" />
    				<h:outputText value="#{event.description}" rendered="#{not event.editable}" />
    			</h:column>
    			<h:column>
       			 	<f:facet name="header">Location</f:facet>
    				<h:inputText value="#{event.location}" rendered="#{event.editable}" />
    				<h:outputText value="#{event.location}" rendered="#{not event.editable}" />
    			</h:column>
    			<h:column>
        			<f:facet name="header">Copy</f:facet>
    				<h:commandButton action="#{iCalBean.copyEvent(event)}" value="C" />
    			</h:column>
    			<h:column>
        			<f:facet name="header">Delete</f:facet>
    				<h:commandButton action="#{iCalBean.deleteEvent(event)}" value="D" />
    			</h:column>
    			<h:column>
        			<f:facet name="header">Edit</f:facet>
        			<h:commandButton action="#{iCalBean.saveEventEdit(event)}" value="Save" rendered="#{event.editable}"/>
    				<h:commandButton action="#{iCalBean.editEventEdit(event)}" value="Edit" rendered="#{not event.editable}"/>
    			</h:column>
			</h:dataTable>
			</h:form>
		</fieldset>
	</div>
</h:body> 
</html>
